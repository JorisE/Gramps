prefix		= @prefix@
exec_prefix	= @exec_prefix@
bindir 		= @bindir@
datadir		= @datadir@/@PACKAGE@
INSTALL		= @INSTALL@
srcdir		= @top_srcdir@
intl_libs       = @INTLLIBS@
p15_inc         = @P15_INCLUDES@
p20_inc         = @P20_INCLUDES@
p21_inc         = @P21_INCLUDES@
p22_inc         = @P22_INCLUDES@
pycomp		= ${srcdir}/py-compile
CFLAGS          = -fPIC -shared -O @CFLAGS@ @CPPFLAGS@ -I@includedir@
LDFLAGS         = @LDFLAGS@ -L@libdir@ @LIBS@
LANG            = sv de fr es it pt_BR

@SET_MAKE@

all:    ${intl_libs}
	chmod +x ${pycomp}
	${pycomp} *.py

intl15.so: intl.c
	$(CC) $(CFLAGS) $(LDFLAGS) $(p15_inc) -DVER15 -o $@ intl.c

intl20.so: intl.c
	$(CC) $(CFLAGS) $(LDFLAGS) $(p20_inc) -DVER20 -o $@ intl.c

intl21.so: intl.c
	$(CC) $(CFLAGS) $(LDFLAGS) $(p21_inc) -DVER21 -o $@ intl.c

intl22.so: intl.c
	$(CC) $(CFLAGS) $(LDFLAGS) $(p22_inc) -DVER22 -o $@ intl.c

install:
	${INSTALL} -d ${datadir}
	(cd ${datadir} ;rm -f *.py *.pyo *.pyc *.glade *.xpm *.so)
	${INSTALL} *.py *.jpg *.pyo *.png *.glade *.xpm *.so ${datadir}
	${INSTALL} -d ${prefix}/share/pixmaps
	${INSTALL} gramps.png ${prefix}/share/pixmaps
	${INSTALL} -d ${prefix}/share/gnome/apps/Applications
	${INSTALL} gramps.desktop ${prefix}/share/gnome/apps/Applications
	for i in ${LANG}; do\
		${INSTALL} -d ${prefix}/share/locale/$$i; \
		${INSTALL} -d ${prefix}/share/locale/$$i/LC_MESSAGES; \
		${INSTALL} locale/$$i/LC_MESSAGES/gramps.mo ${prefix}/share/locale/$$i/LC_MESSAGES; \
		done

uninstall:
	rm -f ${datadir}/*.py ${datadir}/*.pyo ${datadir}/*.glade ${datadir}/*.xpm
	-rmdir ${datadir}

trans: po/template.po
	./build_po

po/template.po: *.py *.glade */*.py */*.glade

clean:
	-rm -f core *.pyo *.pyc *.bak *~	
